---
title: "haplo_afp"
output: html_document
date: "2024-11-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


library(tidyverse)
library(ggtree)
library(ape)
library(phytools)

```

```{r}

#load data into object

owen_tree <- read.newick("C:/Users/omoos/OneDrive/Documents/zoarcoidei/SUPERMATRIX.phylip.treefile")

#relabel tips with correct sp. name

owen_tree$tip.label <- c("Gasterosteus aculeatus", "Lycodes pacificus", "Lycodes diapterus", 
                    "Ophthalmolycus amberensis", "Lycodes concolor", "Lycodes platyrhinus", 
                    "Lycodichthys dearborni", "Melanostigma pammelas", "Melanostigma gelatinosum",
                    "Zoarces viviparus", "Anarhichas minor", "Anarhichas lupus",
                    "Pholis gunnellus", "Cryptacanthodes maculatus", "Leptoclinus maculatus", 
                    "Anoplarchus purpurescens", "Cebidichthys violaceus", "Bathymaster signatus")
#reroot tree with G. aculeatus as root

owen_tree <- reroot(owen_tree, 
             node.number = 1, 
             position = .5*(max(owen_tree$edge.length)))

#edit node labels to be in percentages rather than ratios

owen_tree$node.label <- ifelse(owen_tree$node.label == "Root", "", 
                               ifelse(owen_tree$node.label == "100/100", "100",
                                      ifelse(owen_tree$node.label == "51/71", "72", owen_tree$node.label)))

#remove species with no data

owen_tree <- drop.tip(owen_tree, tip = "Anoplarchus purpurescens")

#plot tree

ggtree(owen_tree) +
  geom_tree(layout = "rectangular", size = 1) +
  geom_tiplab(fontface = "italic", align = TRUE) +
  xlim(0, .16) +
  geom_treescale(x = .01, y = 10,)

```

```{r}
library(readxl)
zoarcoidei_haplo_afp <- read_excel("C:/Users/omoos/Downloads/zoarcoidei_haplo-afp (2).xlsx", sheet = "graph")
View(zoarcoidei_haplo_afp)

zoarcoidei_haplo_afp$Species <- factor(zoarcoidei_haplo_afp$Species, levels = unique(zoarcoidei_haplo_afp$Species))
 
ggplot(zoarcoidei_haplo_afp, aes(x = Haplotype, fill = Type)) + 
  geom_histogram(stat = "count") +
  facet_wrap(~Species) +
  labs(x = "")

```